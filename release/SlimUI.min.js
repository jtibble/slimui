var bootstrapModule=angular.module("bootstrapModule",[]);bootstrapModule.provider("bootstrapper",function(){return{$get:["$http","$q",function(e,o){return{bootstrap:function(t){var r=o.defer();return e.get("config.json").success(function(e){var o=angular.module(t);angular.forEach(e,function(e,t){o.constant(t,e)}),angular.bootstrap(document,[t]),r.resolve()}).error(function(){console.log("Could not initialize application, configuration could not be loaded."),r.reject()}),r.promise}}}]}});var appContainer=document.createElement("div");bootstrapModule.run(["bootstrapper",function(e){e.bootstrap("Framework").then(function(){appContainer.remove()})}]),angular.element(document).ready(function(){angular.bootstrap(appContainer,["bootstrapModule"])});var framework=angular.module("Framework",["ui.router","ui.bootstrap","ngTouch","Framework.Services"]),validateConfigFileStructure=function(e){var o=function(e,o){var t=function(o){console.log("Config.json Validation Error: View/Component '"+e+"' "+o)};return o?o.model&&!o.modelbuilder?(t(" is invalid: if includes model, must also include modelbuilder"),!1):o.modelbuilder&&!o.model?(t(" is invalid: if includes modelbuilder, must also include model"),!1):o.actions&&!o.controller?(t(" is invalid: if includes actions, must also include controller"),!1):o.modelbuilder&&!o.controller?(t(" is invalid: if includes modelbuilder, must also include controller"),!1):!0:(t("can't be validated"),!1)},t=!0;if(e.defaultView&&e.views[e.defaultView]&&(o(e.defaultView,e.views[e.defaultView])||(console.log("Config defaultView exists, but points to an invalid view"),t=!1)),e.views)for(var r in e.views){var n=e.views[r];o(r,n)||(console.log("	View '"+r+"' is invalid with broken template or controller"),t=!1),n.regions&&(n.url||(console.log("View '"+r+"' is invalid: cannot specify regions without 'url' property"),t=!1))}if(e.components)for(var i in e.components)o(i,e.components[i])||(t=!1,console.log("	Component '"+i+"' is invalid with broken template or controller"));return t};framework.config(["$stateProvider","$urlRouterProvider","applicationConfig","$compileProvider","$provide","RouterProvider",function(e,o,t,r,n,i){this.applicationConfig=t,this.postConfigProvider=n,framework._directive=framework.directive,framework.directive=function(e,o){return r.directive(e,o),this},validateConfigFileStructure(t)||console.log("SlimUI ERROR: config.json file is invalid");var a=function(o,r,n){var i,l=function(e,o){var t="";for(var r in o){var n=o[r];t+="/{"+n+"}"}return"/"==e&&(e=""),"/"+e+t},s=function(e,o){return e&&o?o+"."+e:e?e:void console.log("Error: Can't create router state from view name and/or parent view name")};i=r.url?l(r.url,r.parameters):l(o,r.parameters);var c=s(o,n),u={url:i,template:"<div "+o+"></div>"};e.state(c,u);for(var d in r.subroutes){var p=r.subroutes[d],f=t.views[p];a(p,f,n?n+"."+o:o)}};for(var l in t.views){var s=t.views[l];void 0!==s.url&&a(l,s)}var c=t.views[t.defaultView],u=c.url;if(c.parameters)for(var d=0;d<c.parameters.length;d++)u+="/";i.setHomeRoute(u),o.otherwise(function(e,o){return console.log("Invalid location '"+o.$$url+"', going to default route '"+u+"'"),u})}]),framework.run(function(){var e=function(e,o){var t=e.toLowerCase();framework.directive(t,["$http","$controller","$compile","$templateCache","$injector","$q","$stateParams",function(t,r,n,i,a,l,s){function c(t,i){var l=t.$new(),c=e+"Template",u=e+"Model",d=e+"Modelbuilder",p=e+"Actions",f=e+"Controller",v=!1;if(o.template&&!window[c]&&(console.log("Couldn't correctly load template named '"+c+"'."),v=!0),o.model&&!window[u]&&(console.log("Couldn't correctly load model named '"+u+"'."),v=!0),o.model&&!window[u]&&(console.log("Couldn't correctly load modelbuilder named '"+d+"'."),v=!0),o.model&&!window[u]&&(console.log("Couldn't correctly load actions named '"+p+"'."),v=!0),o.model&&!window[u]&&(console.log("Couldn't correctly load controller named '"+f+"'."),v=!0),v)return void console.log("Check spelling in file and config.json. Aborting creation of '"+e+"'");var m=function(e){var o;try{o=a.annotate(window[e])}catch(t){console.log("Error: Failed to find dependency injection information for '"+e+"'.\n	Please check in the file that the function name is spelled correctly.")}var r=[];for(var n in o){var i=o[n];if("Context"!=i&&"Actions"!=i&&"Model"!=i&&"Modelbuilder"!=i&&"StateParameters"!=i)try{a.get(i)}catch(l){r.push(i)}}r.length&&console.log("Error: Not all of "+e+"'s dependencies have been loaded correctly.\n	Missing dependencies: "+r.toString()+"\nIf these are newly-added dependency injections, have they been added to config.json and named correctly? Additionally, check that the spelling in "+e+" matches the function name in the dependency's JavaScript file.")};o.modelbuilder&&m(d),o.actions&&m(p),o.controller&&m(f);var g,w,h;if(window[u])try{var y={Model:window[u]()};g=r(window[d],y)}catch(b){console.log("Error: Could not inject model into modelbuilder '"+d+"'. Exception: \n	"+b.message)}if(window[p])try{var C={Context:l};g&&(C.Modelbuilder=g),w=r(window[p],C)}catch(b){console.log("Error: Could not inject context or modelbuilder into actions '"+p+"'. Exception: \n	"+b.message)}try{var k={Context:l,StateParameters:s};g&&(k.Modelbuilder=g),w&&(k.Actions=w),h=r(window[f],k)}catch(b){console.log("Error: Could not inject dependencies into controller '"+f+"'. Likely cause: Actions or Modelbuilder is trying to use a service that was not injected. Check Actions and Modelbuilder injections. Exception: \n	"+b.message)}i.html(window[c]),i.children().data("$ngControllerController",h),n(i.contents())(l)}return{link:c,scope:{attributeParameter:"@"}}}])},o=function(e){return function(){return{template:e}}},t=function(t,r){r.model||r.modelbuilder||r.actions||r.controller?e(t,r):(templateName=t+"Template",t=t.toLowerCase(),framework.directive(t,o(window[templateName])))};for(var r in this.applicationConfig.components){var n=applicationConfig.components[r];t(r,n)}for(var i in this.applicationConfig.views){var a=applicationConfig.views[i];t(i,a)}window.servicesToInject={};var l=function(e){return{$get:window[e]}};for(var s in this.applicationConfig.services)window[s]?(window.servicesToInject[s]=l(s),this.postConfigProvider.provider(s,window.servicesToInject[s])):console.log("Error: '"+s+"' service was specified in config.json but has not been loaded. Check that it exists in your compiled application.")});var framework=angular.module("Framework.Services",[]);framework.provider("Router",function(){var e,o={notRouting:"Router is not navigating to the same route",routingHome:"Router is going to default screen "};return{$get:["$state",function(t){return{goTo:function(e,r){t.current.name!==e||r?t.go(e,r):console.log(o.notRouting)},goToHome:function(){console.log(o.routingHome+e),t.go(e)},getStateParameters:function(){return t.params}}}],setHomeRoute:function(o){e=o}}}),framework.provider("ControllerCommunication",function(){var e={},o={};return{$get:function(){return{registerCallback:function(e,t){o[e]||(o[e]=[]),o[e].push(t)},notifyObservers:function(e){o[e]&&o[e].length&&angular.forEach(o[e],function(e){e()})},get:function(o){return"undefined"!=e[o]?e[o]:(console.log("ControllerCommunication Error: no channel '"+o+"' existing to return data"),!1)},set:function(o,t){e[o]=t,this.notifyObservers(o)}}}}}),framework.provider("FrameworkAJAX",function(){return{$get:["$http",function(e){return{sendRequest:function(o,t,r){return o.method&&o.url&&o.data?e(o).success(t).error(r):void console.log("Error making AJAX request: missing method, url, or data.")}}}]}}),framework.provider("Promise",function(){return{$get:["$q",function(e){return{promisesStorage:{},createDeferred:function(o){return this.promisesStorage[o]=e.defer(),!0},getPromise:function(e){return this.promisesStorage[e]?this.promisesStorage[e].promise:(console.log("Can't return promise: deferred not created correctly"),!1)},resolveDeferred:function(e,o){return this.promisesStorage[e]&&this.promisesStorage[e].resolve?(this.promisesStorage[e].resolve(o),!0):(console.log("Can't resolve: deferred not created correctly"),!1)},rejectDeferred:function(e,o){return this.promisesStorage[e]&&this.promisesStorage[e].reject?(this.promisesStorage[e].reject(o),!0):(console.log("Can't reject: deferred not created correctly"),!1)}}}]}}),framework.provider("PropertyValidation",function(){return validationMappings={},{$get:function(){return{validationTypes:{required:"Validates that an input has (or does not have) a value set",length:"Validates that an input's length is a precise number of characters",min:"Validates that an input's value is greater than a certain value",max:"Validates that an input's value is less than a certain value",regex:"Validates that an input conforms to a particular structure",script:"Validates properties with respect to each other",type:"Validates that the property is the correct type (int, string, etc)"},getPropertyValidationTypes:function(){return this.validationTypes},addPropertyValidation:function(e,o,t){return void 0===this.validationTypes[o]?(console.log("Cannot add unknown validation type '"+o+"'"),!1):(validationMappings[e]||(validationMappings[e]=[]),void validationMappings[e].push({validationType:o,validationValue:t}))},getPropertyValidationRules:function(e){return validationMappings[e]?validationMappings[e]:[]}}}}}),framework.provider("SchemaValidation",function(){return{$get:["$http","PropertyValidation",function(e,o){return{loadSchema:function(t){e.get(t).success(function(e){e.schemaName;for(var t in e.properties){var r=e.properties[t];for(var n in r){var i=r[n];o.addPropertyValidation(t,n,i)}}}).error(function(){console.error("Cannot fetch schema '"+t+"'")})}}}]}}),framework.directive("slimuivalidate",["PropertyValidation",function(e){return{require:"ngModel",restrict:"A",link:function(o,t,r,n){n&&(n.$validators.propertyValidation=function(o,t){var i=r.slimuivalidate,a=e.getPropertyValidationRules(i),l={required:function(e){return!e||e&&t.toString().length>0?!0:!1},length:function(e){return t.toString().length===e?!0:!1},min:function(e){return t>=e?!0:!1},max:function(e){return e>=t?!0:!1},regex:function(e){return"string"==typeof e&&(e=new RegExp(e)),e.test(t)},script:function(){console.error("no script-validation in-place yet")},type:function(e){switch(e){case"date":var o=isNaN(new Date(t)),r="Invalid Date"===new Date(t);return o||r?!1:!0;case"number":return!isNaN(Number.parseFloat(t));case"int":var n=!isNaN(Number.parseInt(t)),i=Number.parseInt(t)===Number.parseFloat(t);return n&&i;case"string":return"string"==typeof t;default:return console.log("could not check type of value"),!1}}};for(var s in a){var c,u=a[s],d=u.validationType,p=u.validationValue;if(!l[d])throw"Cannot validate unknown validation rule type '"+d+"'!";if(c=l[d](p),n.$setValidity(d,c),!c)return!1}})}}}]);